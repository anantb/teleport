<!-- 
@author: Anant Bhardwaj

Teleport Web Page
-->
<!DOCTYPE html> 
<html> 
<head> 
	<title>Teleport</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
	<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/teleport.css" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel=stylesheet href='css/firstpersoncam.css' type='text/css' />
    <!-- *** Replace the key below below with your own API key, available at http://code.google.com/apis/maps/signup.html *** -->
    <script src="http://www.google.com/jsapi?key=AIzaSyAdgYw9dd2TiekDSJ7tsQC0ogDcDwD673s"></script>
    <script type="text/javascript" src="lib/keyboard-focus-hack.js"></script>
    <script type="text/javascript" src="lib/math3d.js"></script>
    <script type="text/javascript" src="javascript/firstpersoncam.js"></script>
    <script src="http://static.opentok.com/webrtc/v2.0/js/TB.min.js" ></script>
</head>
<body>

<script type="text/javascript">
$(document).bind("mobileinit", function(){
   $.mobile.defaultTransition = 'none'
});


console.log('teleportme')
google.load("earth", "1");
google.load("maps", "2");

var ge = null;
var cam;

function init() {
    init3D();
}

function initCB(object) {
    ge = object;
    ge.getOptions().setFlyToSpeed(100);

    //ge.getLayerRoot().enableLayerById(ge.LAYER_ROADS, true);
    ge.getLayerRoot().enableLayerById(ge.LAYER_BUILDINGS, true);
    // ge.getLayerRoot().enableLayerById(ge.LAYER_TERRAIN, true);
    //ge.getLayerRoot().enableLayerById(ge.LAYER_TREES, true);

    cam = new FirstPersonCam();
    cam.refreshCamera();
    ge.getWindow().setVisibility(true);

    keyboardFocusHack(ge);
}

function failureCB(object) {
    alert("somthing went wrong!")
}

function init3D() {
    google.earth.createInstance("map3d", initCB, failureCB);
} 





$("#teleport").live('pageinit', function (e) {       
    
    $('#map-container').keyup(function(event) {
        console.log(event)
        return keyUp(event);
      
    });

     $('#map-container').keydown(function(event) {
        console.log(event)
        return keyDown(event);
      
    });
    init()

});


$("#teletalk").live('pageinit', function(e){
    // Initialize API key, session, and token...
    // Think of a session as a room, and a token as the key to get in to the room
    // Sessions and tokens are generated on your server and passed down to the client
   

    var apiKey = "25730622";
    var sessionId = "1_MX4yNTczMDYyMn4xMjcuMC4wLjF-V2VkIEFwciAxNyAyMDo1NDowMCBQRFQgMjAxM34wLjk0NDA3NjM2fg";
    var token = "T1==cGFydG5lcl9pZD0yNTczMDYyMiZzZGtfdmVyc2lvbj10YnJ1YnktdGJyYi12MC45MS4yMDExLTAyLTE3JnNpZz02NTk0OGQ3Mzk3MDZiNWY0OTk5NzJlMmNiOTVmZjVkOWFlNmRmMzM0OnJvbGU9cHVibGlzaGVyJnNlc3Npb25faWQ9JmNyZWF0ZV90aW1lPTEzNjYyNTcyMzkmbm9uY2U9MC43NzUxMTkwNDk5MzM4NTc2JmV4cGlyZV90aW1lPTEzNjYzNDM2NDAmY29ubmVjdGlvbl9kYXRhPQ==";

    // Enable console logs for debugging
    TB.setLogLevel(TB.DEBUG);

    // Initialize session, set up event listeners, and connect
    var session = TB.initSession(sessionId);
    session.addEventListener('sessionConnected', sessionConnectedHandler);
    session.addEventListener('streamCreated', streamCreatedHandler);
    session.connect(apiKey, token);
    function sessionConnectedHandler(event) {
        var publisher = TB.initPublisher(apiKey, 'my-chat-window');
        session.publish(publisher);

        // Subscribe to streams that were in the session when we connected
        subscribeToStreams(event.streams);
    }

    function streamCreatedHandler(event) {
        // Subscribe to any new streams that are created
        subscribeToStreams(event.streams);
    }

    function subscribeToStreams(streams) {
        for (var i = 0; i < streams.length; i++) {
        // Make sure we don't subscribe to ourself
            if (streams[i].connection.connectionId == session.connection.connectionId) {
              return;
            }

            // Create the div to put the subscriber element in to
            var div = $('<div></div>');
            div.appendTo($('#chat-windows'))
            div.attr('id', 'stream' + streams[i].streamId);
            //document.body.appendChild(div);
            // Subscribe to the stream
            session.subscribe(streams[i], div.attr('id'));
        }
    }


});



</script>


<div data-role="page" class="ui-responsive-panel" id="login">

    <div data-role="header">
    <h1>Teleport</h1>
    </div><!-- /header -->

    <div data-role="content" data-theme="b" data-content-theme="d"> 

    <form method="POST" action="#home" data-ajax="false">
        <label for="login_email">Email</label>
        <input type="email" name="login_email" id="login_email" value="">
        <label for="login_password">Password</label>
        <input type="password" name="login_password" id="login_password" value="" autocomplete="off">
        <button id="login_submit" type="submit">Submit</button>
    </form>

    </div><!-- /content -->

</div><!-- /login -->



<div data-role="page" id="home" class="teleport">
    <div data-role="header">
        <h1>Teleport</h1>
        <a href="#settings" data-icon="gear" class="ui-btn-right">Settings</a>
	    <div data-role="navbar">
	            <ul>
	                <li><a href="#home" data-icon="home" class="ui-btn-active ui-state-persist">Home</a></li>
	                <li><a href="#contacts" data-icon="grid">Contacts</a></li>
	                <li><a href="#teletalk" data-icon="bars">TeleTalk</a></li>
                    <li><a href="#teleport" data-icon="arrow-r">Teleport Me</a></li>
	            </ul>
	    </div><!-- /navbar -->
    
    </div><!-- /header -->
    <div data-role="content">
        <div data-role="collapsible" data-collapsed="false" data-theme="b" data-content-theme="d">
            <h4>New Notifications</h4>
            <ul data-role="listview" data-theme="d">
                <li data-icon="delete"><a href="#">
                    <p><strong>Alex Pagan wants to add you to his contact list.</strong></p>
                    <p>Hey Anant, This is Alex Pagan!.</p>  
                    <span class="ui-li-count">April 17, 2013 05:49 PM</span>                     
                </a></li>
                <li data-icon="delete"><a href="#">
                    <p><strong>Ekaterina Ob'yedkova has new tweets.</strong></p>
                    <p>The trip to New York was amazing...</p>
                    <span class="ui-li-count">April 17, 2013 11:04 AM</span>   
                </a></li>
                <li data-icon="delete"><a href="#">
                    <p><strong>Raj Aryan accepted your friend request.</strong></p>
                    <span class="ui-li-count">April 16, 2013 06:09 PM</span>   
                </a></li>
            </ul>
        </div>
         <br />
        <div data-role="collapsible" data-collapsed="false" data-theme="b" data-content-theme="d">
            <h4>Recent Contacts</h4>
            <ul data-role="listview" data-theme="d">               
                <li data-icon="forward"><a href="#contact">
                    <p><strong>Alex Pagan</strong></p>
                    <span class="ui-li-count">April 17, 2013 06:09 PM</span>             
                </a></li>
                <li data-icon="back"><a href="#contact">
                    <p><strong>Ekaterina Ob'yedkova</strong></p>
                    <span class="ui-li-count">April 17, 2013 11:45 AM</span>
                </a></li>
                <li data-icon="forward"><a href="#contact">
                    <p><strong>Raj Aryan</strong></p>
                    <span class="ui-li-count">April 15, 2013 06:57 PM</span>
                </a></li>
                <li data-icon="alert"><a href="#contact">
                    <p><strong>Sarah Lehmann</strong></p>
                    <span class="ui-li-count">April 14, 2013 11:29 AM</span>
                </a></li>
            </ul>
        </div>
       
        
    </div>
	
</div><!-- /home -->


<div data-role="page" data-theme="b" id="contacts" class="teleport grid">
    <div data-role="header">
        <h1>Teleport</h1>
        <a href="#settings" data-icon="gear" class="ui-btn-right">Settings</a>
	    <div data-role="navbar">
	            <ul>
	                <li><a href="#home" data-icon="home">Home</a></li>
	                <li><a href="#contacts" data-icon="grid" class="ui-btn-active ui-state-persist">Contacts</a></li>
	                <li><a href="#teletalk" data-icon="bars">TeleTalk</a></li>
                    <li><a href="#teleport" data-icon="arrow-r">Teleport Me</a></li>
	            </ul>
	    </div><!-- /navbar -->
        
    </div><!-- /header -->
    <div data-role="content">
        <ul data-role="listview" data-inset="true" data-filter="true" data-filter-placeholder="Search contacts">
            <li><a href="#contact">
                <img src="images/profile.png">
                <h2>Anant Bhardwaj</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li><a href="#contact">
                <img src="images/profile.png">
                <h2>Alex Pagan</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li><a href="#contact">
                <img src="images/profile.png">
                <h2>Ekaterina Ob'yedkova</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li><a href="#contact">
                <img src="images/profile.png">
                <h2>Rob Miller</h2>
                <p>MIT Professor</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li><a href="#contact">
                <img src="images/profile.png">
                <h2>Sarah Lehmann</h2>
                <p>Amazing TA</p>
                <p class="ui-li-aside">Online</p>
            </a></li>            
            <li><a href="#contact">
                <img src="images/profile.png">
                <h2>Raj Aryan</h2>
                <p>San Francisco</p>
                <p class="ui-li-aside">Away</p>
            </a></li>
            <li><a href="#contact">
                <img src="images/profile.png">
                <h2>David Cheriton</h2>
                <p>Stanford</p>
                <p class="ui-li-aside">Away</p>
            </a></li>
            <li><a href="#contact">
				<img src="images/profile.png">
                <h2>Sam Madden</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Away</p>
            </a></li>
        </ul>
    </div><!-- /contacts -->   
</div>




<div data-role="page" id="teleport" class="teleport">
    <div data-role="header">
        <h1>Teleport</h1>
        <a href="#settings" data-icon="gear" class="ui-btn-right">Settings</a>
        <div data-role="navbar">
                <ul>
                    <li><a href="#home" data-icon="home">Home</a></li>
                    <li><a href="#contacts" data-icon="grid">Contacts</a></li>
                    <li><a href="#teletalk" data-icon="bars">TeleTalk</a></li>
                    <li><a href="#teleport" data-icon="arrow-r" class="ui-btn-active ui-state-persist">Teleport Me</a></li>
                </ul>
        </div><!-- /navbar -->
    
    </div><!-- /header -->
    <div data-role="content" style="position:relative;">
    
       
            <input type="search" name="earth-search-input" id="earth-search-input" placeholder="MIT" value=""/>
      
       
        <div id="map-container"> 
            <div id='map3d'></div>
        </div>
       
    </div>
    
</div><!-- /home -->


<div data-role="page" id="teletalk" class="teleport" class="ui-responsive-panel">
        <div data-role="header">
            <h1>Teleport</h1>
            <a href="#contacts-panel" data-icon="plus" class="ui-btn-left">Add People to TeleTalk</a>
            <a href="#settings" data-icon="gear" class="ui-btn-right">Settings</a>
            <div data-role="navbar">
                    <ul>
                        <li><a href="#home" data-icon="home">Home</a></li>
                        <li><a href="#contacts" data-icon="grid">Contacts</a></li>
                        <li><a href="#teletalk" data-icon="bars" class="ui-btn-active ui-state-persist">TeleTalk</a></li>
                        <li><a href="#teleport" data-icon="arrow-r">Teleport Me</a></li>
                    </ul>
            </div><!-- /navbar -->        
        </div><!-- /header -->
        <div data-role="panel" id="contacts-panel">
            <ul data-role="listview" data-inset="true" data-filter="true" data-filter-placeholder="Search contacts">
            <li data-icon="plus"><a href="#">
                <h2>Anant Bhardwaj</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li data-icon="plus"><a href="#">
                <h2>Alex Pagan</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li data-icon="plus"><a href="#">
                <h2>Ekaterina Ob'yedkova</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li data-icon="plus"><a href="#">
                <h2>Rob Miller</h2>
                <p>MIT Professor</p>
                <p class="ui-li-aside">Online</p>
            </a></li>
            <li data-icon="plus"><a href="#">
                <h2>Sarah Lehmann</h2>
                <p>Amazing TA</p>
                <p class="ui-li-aside">Online</p>
            </a></li>            
            <li data-icon="plus"><a href="#">
                <h2>Raj Aryan</h2>
                <p>San Francisco</p>
                <p class="ui-li-aside">Away</p>
            </a></li>
            <li data-icon="plus"><a href="#">
                <h2>David Cheriton</h2>
                <p>Stanford</p>
                <p class="ui-li-aside">Away</p>
            </a></li>
            <li data-icon="plus"><a href="#">
                <h2>Sam Madden</h2>
                <p>MIT</p>
                <p class="ui-li-aside">Away</p>
            </a></li>
        </ul>
        </div><!-- /panel -->
        <div data-role="content">
        <div id="chat-windows">
            <div id="my-chat-window">
            </div>
        </div>
        </div>

</div><!-- /home -->


<div data-role="page" id="contact" class="teleport">
        <div data-role="header">
            <h1>Teleport</h1>
            <a href="#contacts" data-icon="bars" class="ui-btn-left">All Contacts</a>
            <a href="#settings" data-icon="grid" class="ui-btn-right">Settings</a>
            <div data-role="navbar">
                    <ul>
                        <li><a href="#home" data-icon="home">Home</a></li>
                        <li><a href="#contacts" data-icon="grid" class="ui-btn-active ui-state-persist">Contacts</a></li>
                        <li><a href="#teletalk" data-icon="bars">TeleTalk</a></li>
                        <li><a href="#teleport" data-icon="arrow-r">Teleport Me</a></li>
                    </ul>
            </div><!-- /navbar -->        
        </div><!-- /header -->
        <div data-role="content">
            <a href="#teletalk" data-role="button">Call</a>
            <br />
            <div class="ui-grid-a">
                <div class="ui-block-a" style="width:30%;">   
                    <img src="images/profile.png" style="height:100%; height:200px; margin:0 auto;">
                    <p><strong>Raj Aryan<strong></p>
                    <p>San Francisco</p>
                </div>
                <div class="ui-block-b" style="width:70%;">
                    <div data-role="collapsible" data-collapsed="false" data-theme="b" data-content-theme="d">
                    <h4>Recent Tweets</h4>
                    <ul data-role="listview" data-theme="d">               
                        <li><p>Whew.. Funny , Amusing yet imp imp msg. http://100percentmen.tumblr.com/</p></li>

                        <li><p>Via Verde | Dattner Architects/Grimshaw Architects | New York | Building Types Study | Architectural Record http://archrecord.construction.com/projects/Building_types_study/Multi-Family-Housing/2012/via-verde-dattner-architects-grimshaw-architects.asp#.UW_CopzNU-Y.twitter …</p></li>

                        <li><p>Five days left in the Stanford Story Slam! Team creative writing for a $500 prize: http://ensemble.stanford.edu/storyslam </p></li>

                        <li><p>#highered @udacity: MOOC 2.0 is live: MOOCs with personalized mentoring and college credit, at 1980s tuition levels: http://bit.ly/15bFDny</p></li>

                        <li><p>Ideas are coming in! Check out # and RT the 1 you want to do. Reply with suggestions.</p></li>
                        
                    </ul>
        </div>
                    
                </div>

            </div><!-- /grid-a -->
            
                
                
                  
                
                    
                
            
        </div>
        

</div><!-- /home -->








</body>
</html>
