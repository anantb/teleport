<!--
@author: Anant Bhardwaj

Teleport Web Page
-->

<!DOCTYPE HTML>
<html>
  <head>
    <title>Teleport</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel=stylesheet href='/tp_static/css/style.css' type='text/css' />
    <link href='http://fonts.googleapis.com/css?family=Tangerine' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="http://static.opentok.com/webrtc/v2.0/js/TB.min.js" ></script>

    <!-- node.js serves the socket.io client -->
    <script src="http://anantb.csail.mit.edu:3000/socket.io/socket.io.js"></script>
    <script src="/tp_static/javascript/teleport.js"></script>

  </head>

  <body>

<script type="text/javascript">
    var apiKey = '{{api_key}}';
    var userId = '{{login_id}}';

    $(document).ready(function(){
        initTeletalk(apiKey, userId)

        $('#send').click(function() {
            var message = $('#field').val();
            sendMessage(message);
        });

        $("#invite").click(function() {
            var invitee = $('#invitee').val()
            inviteUser(invitee);
        });

        $('form').on('submit', function () {
            return false;
        });

        if (!invited) {
            initiateChat();
        } else {
            joinChat(_session_id);
        }

    });

</script>



    <div id="header">

        <span id="headlink-left">
        {% block headlink-left %}<a id="logo" href="/">Teleport</a>{% endblock %}
        </span>
        <span id="headlink-right">
        <a href="/logout">Log out</a>
        </span>

    </div>


    <div id="page">
      <div id="content">
        <table id="content-layout">
          <tr>
            <td class="col-small user-profile">
              <span class="profile-big"></span>
            </td>
            <td class="col-big search">
              <div class="search-container">
                <input type="text" id="search_contacts" class="search-box" title="Search Contacts"></input>
              </div>
            </td>
          </tr>

          <tr>

            <td class="col-small">
              <div class="links">
                <a class="nav" href="/contacts">Contacts</a>
                <a class="nav" href="/feed">Feed</a>
                <a class="nav active" href="/teleport">Teleport</a>
              </div>
            </td>

            <td class="col-big">

                <div class="content-inner">
                    <div id="video-chat-container">
                      <div id="chat-windows"></div>
                    </div>

                    <div id="text-chat-container">
                        <h3 class="chat-header">Chat</h3>
                        <div id="messages">
                        </div>
                    </div>
                </div>

                <div id="bottom-panel">
                    <div class="mini-chat">
                        <div id="my-chat-window"></div>
                    </div>

                    <div class="chat-controls" >
                      <form class="chat-form">
                        <div class="">
                            <div>
                                <input class="large-text" id='field' type="text" />
                                <input class="right" id='send' type="submit" value="Send" />
                            </div>
                            <br>
                            <div>
                                <input id='invitee' class="large-text" type="text" />
                                <input id='invite' type="submit" value="+ Invite" />
                            </div>
                        </div>
                      </form>
                    </div>

                </div>
            </td>

          </tr>
        </table>
      </div>
    </div>
  </body>
</html>
